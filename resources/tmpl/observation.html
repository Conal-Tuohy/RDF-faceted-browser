<html>
<head>
<link rel="StyleSheet" href="styles/human_readable.css" type="text/css" />
  <script type="text/javascript" src="externals/jquery-1.4.2.min.js"></script>
</head>
<script>
function traverse(dim_val,dim_uri,obs_uri,dir){
	action='nextdimension';
	if(dir=='next'){
	action='next';
	}
	else{
	action='pre';
	}
	var ajax_load = "<img class='loading' src='./views/images/loading.gif' alt='loading...' />";
	arr_dimuri=document.getElementsByName('dimuri');
	arr_dimlab=document.getElementsByName('dimlab');
	arr_dimval=document.getElementsByName('dimval');
	arr_dimvaluri=document.getElementsByName('dimvaluri');
	arr_dimindirect=document.getElementsByName('dimindirect');
	measureURI=document.getElementById('measureURI').value;
	measurelab=document.getElementById('measurelab').value;
	str="rt=uri/traverse"
	+"&dir="+action
	+"&uri="+obs_uri
	+"&endpoint="+document.getElementById('endpoint').value
	+"&dimuri="+dim_uri
	+"&dimval="+dim_val
	+"&arr_dimuri="+toArray(arr_dimuri).toString()
	+"&arr_dimval="+toArray(arr_dimval).toString()
	+"&measure="+measureURI

	$('#txtHint').html(ajax_load)
	$.ajax({
	    url: 'get-observation-detail',
		data:str,
	    type: 'POST',
	    timeout: 1000,
		dataType:"json",
	    error: function(){
	        alert('No Observation exists...');
			window.location="get-observation-detail?uri="+obs_uri.replace('#','%23')+"&endpoint="+document.getElementById('endpoint').value;
	    },
	    success: function(o){
	    if(o.status==="ok"){
		 window.location="get-observation-detail?uri="+o.uri.replace('#','%23')+"&endpoint="+document.getElementById('endpoint').value;
		 }

	    }
		
		
	});
	return false;
	}
function toArray(obj) {
	  var array = [];
	  // iterate backwards ensuring that length is an UInt32
	  for (var i = obj.length >>> 0; i--;) { 
	    array[i] = obj[i].value;
	  }
	  return array;
	}

</script>
<body>

<input name="uri_txt" id="uri_txt" type="hidden" value="${oburi}" />
<input name="endpoint" id="endpoint" type="hidden" value="${endpoint}" />

<div class="container">
<div class="center" id="txtHint">
<hr/>

<table class="dimensiontable" border="0" width="100%">
<tr>
<td colspan="2">
<h3 class="measure">
<span>${observation.measure.label!""}<input type='hidden' id='measureURI' value='${observation.measure.uri!""}' />
<input type='hidden' id='measurelab' value='${observation.measure.label!""}' />
</span>
</h3>
</td>
</tr>

<tr>
<td width="50%">
<h1 class="observation">
<span>${observation.measure.value!""}</span>
</h1>

</td>
<td width="50%" class="attribute">	
</td>

</tr>
</table>

<hr/>


<table class="dimensiontable" border="0" width="100%">



<#list properties?keys as key> 
	<tr>   
		<td>
		<h5 class="dimension">
	    ${key} 
		</h5>
	    </td>
	    <td>
	    ${properties[key]}
		</td>
	</tr>
</#list>

</table>
<table class="dimensiontable" border="0" width="100%">



<#list observation.dimensions as dimension> 
	<tr>   
		<td>
		<h5 class="dimension">
		${dimension.label!""} :
		</h5>
	    </td>
	    <td>
		<img onclick="traverse('${dimension.value}','${dimension.uri}','${observation.uri}','pre')" alt="left" src="images/left.gif"/>
		${dimension.value}
		<img onclick="traverse('${dimension.value}','${dimension.uri}','${observation.uri}','next')" alt="right" src="images/right.gif"/>
		
		<input type='hidden' name='dimuri' value='${dimension.uri}'></input>
		<input type='hidden' name='dimval' value='${dimension.value}' ></input>
		
		</td>
	</tr>
</#list>

</table>











</div>
</div>
</body>
</html>